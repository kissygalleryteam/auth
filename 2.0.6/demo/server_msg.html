<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>配合服务器输出的消息</title>
    <script src="http://g.tbcdn.cn/kissy/k/1.4.7/seed-min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="http://g.tbcdn.cn/kissy/k/1.4.7/css/dpl/??base-min.css,forms-min.css">
    <link rel="stylesheet" href="http://g.tbcdn.cn/kissy/k/1.4.7/??css/dpl/base-min.css,css/dpl/forms-min.css,button/assets/dpl-min.css">
</head>
<body>
<h2>配合服务器输出的消息</h2>
<p>服务器端输出的错误消息，可以放在消息容器内，Msg类会自动处理</p>
<form class="form-horizontal" id="J_Auth" method="post" action="">
    <div class="control-group">
        <label class="control-label" for="user">用户名</label>
        <div class="controls">
            <input type="text" class="input-xlarge" id="user"
                   min-len="5"
                   msg-wrapper="#J_UseMsg"
            >
            <div id="J_UseMsg">
                <!--这里是服务器输出的错误消息 auth-msg样式名必须存在-->
                <p class="auth-msg auth-error">请您输入至少5个字符</p>
            </div>
        </div>
    </div>
    <div class="control-group">
        <label class="control-label"></label>
        <div class="controls">
            <button class="ks-button" id="J_TestUser">验证用户名</button>
        </div>
    </div>
</form>


<script>
    var S = KISSY;

    if (S.Config.debug) {
        var srcPath = "../";
        S.config({
            packages:[
                {
                    name:"kg/auth/2.0.6",
                    path:srcPath,
                    charset:"utf-8",
                    ignorePackageNameInUri:true
                }
            ]
        });
    }


    S.use('kg/auth/2.0.6/,kg/auth/2.0.6/plugin/msgs/,kg/auth/2.0.6/plugin/msgs/style.css', function (S, Auth,AuthMsgs) {
        var auth = new Auth('#J_Auth');
        auth.plug(new AuthMsgs());
        //注册一个自定义规则
        auth.register('min-len', function (value,attr,defer,field) {
           var min = Number(attr);
           this.msg('error','请您输入至少'+min+'个字符');
           return value.length >= Number(attr);
        });
        auth.render();
        var user = auth.getField('user');

        S.one('#J_TestUser').on('click',function(ev){
            user.test();
            ev.preventDefault();
        })
    })
</script>

</body>
</html>
